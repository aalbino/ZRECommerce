<?php
/**
 * ZRECommerce e-commerce web application.
 * 
 * @author ZRECommerce
 * 
 * @package Admin
 * @subpackage Admin_Articles
 * @category Admin
 * 
 * @version $Id$
 * @copyright Copyrights 2008 ZRECommerce. All rights reserved.
 * @license Creative Commons license - See public/license.txt
 */

$settings = ZRE_Config::getSettingsCached();
$t = Zend_Registry::get('Zend_Translate');

$this->headTitle((string)$settings->site->title, Zend_View_Helper_Placeholder_Container_Abstract::SET);
if (empty($this->title)) $this->title = (string)$settings->site->title;
$this->placeholder('title')->set($this->title);

$vars = $this->getVars();
$params = $vars['params'];

if (isset($vars['enable_dojo']) && $vars['enable_dojo'])
{
	$this->dojo()->enable()
		->setDjConfigOption('parseOnLoad', true);
}
if (isset($vars['content'])) echo $vars['content'];

// Menu
$config = array(
	'All' => 		array('id'=>'mnuAdminArticleAll', 'class'=>'menuItem', 'url'=>'/admin/articles/'),
	'New' => 		array('id'=>'mnuAdminArticleNew', 'class'=>'menuItem', 'url'=>'/admin/articles/new/'),
	'Types' =>		array('id'=>'mnuAdminArticleTypes', 'class'=>'menuItem', 'url'=>'/admin/articles/types/'),
	'Categories' => array('id'=>'mnuAdminArticlesCategories', 'class'=>'menuItem', 'url'=>'/admin/articles/categories/')
);
echo new Zre_Ui_Menu('mnuOptions', $config);

$articlesCategoryTree = new Zre_Ui_Jquery_Tree('articleCategoryTree', '/admin/articles/ajax.category.edit/');
			
$this->headScript()->appendFile( '/scripts/jquery/jqueryFileTree/jqueryFileTree.js' );
$this->headScript()->appendScript( $articlesCategoryTree->getScript() );

$updateForm = new Zre_Ui_Form_Article_Categories();

if ($params['is_submitted'] == 1) {
	// ...Process updated info
	
	Zre_Dataset_Article::updateContainer( $params );
	
	echo '<div class="ok">' . $t->_('Category updated.') . '</div>';
}

?>
<p>
<?php echo $t->_('article_info_new'); ?>
</p>
<div style="width: 100%; position: relative; display: block; margin: auto; min-height: 600px;">
	<div style="float: left; width: 25%; height: 600px; overflow: scroll;">
		<?php echo $articlesCategoryTree->getHtml();?>
	</div>
	<div style="width: 95%;">
		
		<div><?php echo $updateForm; ?></div>
		<div><?php echo ''; ?></div>
		
	</div>
</div>